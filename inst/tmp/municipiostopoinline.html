<!DOCTYPE html>
<meta charset="utf-8">

<body style="background-color:black">
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="http://d3js.org/topojson.v1.min.js"></script>
    <!-- I recommend you host this file on your own, since this will change without warning -->
    <!-- <script src="http://datamaps.github.io/scripts/datamaps.world.min.js?v=1"></script> -->

    <script src="js/datamaps.none.min.js"></script>

    <!-- <div id="container1" style="position: relative; width: 80%; max-height: 450px;"></div> -->
    <div id="container1" width="100%" style="background-color:white"></div>

    <script>

    var data = {
        bubblesdata: [{
            "name": "Medellín",
            "latitude": 6.2914,
            "longitude": -75.536,
            "radius": 16,
        }, {
            "name": "Apartadó",
            "latitude": 7.8856,
            "longitude": -76.635,
            "radius": 7,
            "fillKey": "Guerrilla"
        }, {
            "name": "Bello",
            "latitude": 6.3389,
            "longitude": -75.562,
            "radius": 6.3389,
            "fillKey": "Guerrilla"
        }, {
            "name": "Bello",
            "latitude": 6.3389,
            "longitude": -75.562,
            "radius": 6.3389,
            "fillKey": "C"
        }, {
            "name": "San José del Guaviare",
            "latitude": 2.5683,
            "longitude": -72.642,
            "radius": 5.25,
            "fillKey": "Guerrilla"
        }],
        "fills": {
            "B": "#F3F2E5",
            "C": "#993F00",
            "A": "#1F8E99",
            "defaultFill": "#d2e1bf"
        }

    };


    //basic map config with custom fills, mercator projection
    var map = new Datamap({
        element: document.getElementById('container1'),
        geographyConfig: {
            borderColor: '#f5f8ef',
            highlightFillColor: '#516a52',
            highlightBorderColor: '#279945',
            highlightBorderWidth: 2,
            // dataUrl: 'js/municipios.col.json'
            popupTemplate: function(geography, data) {
                return '<div class="hoverinfo">' + geography.properties.NOMBRE_MPI
            },
            dataUrl: 'js/mpio.topo.json'
            // dataUrl: 'js/depto.topo.json'
        },
        scope: 'mpio',
        responsive: true,
        // Zoom in on Africa
        setProjection: function(element) {
            var projection = d3.geo.mercator()
                .center([-73.5, 4.2])
                .rotate([0, 0])
                .scale(2 *element.offsetWidth)
                .translate([element.offsetWidth / 2, element.offsetHeight / 2]);
            var path = d3.geo.path()
                .projection(projection);

            return {
                path: path,
                projection: projection
            };
        },
        fills: {
            defaultFill: '#d2e1bf',
            latam: '#458063',
            bubble1: '#432342',
            bubble2: '#485308',
            Guerrilla: '#f45298'
        },
        // fills: data.fills,
        data: {
            44847: {
                fillKey: 'Guerrilla'
            },
            70400: {
                fillKey: 'bubble1'
            },
            54670: {
                fillKey: 'latam'
            }
        }


        ,
            bubblesConfig: {
                borderWidth: 2,
                borderColor: '#FFFFFF',
                popupOnHover: true,
                popupTemplate: function(geography, data) {
                  return '<div class="hoverinfo"><strong>' + data.name + '</strong></div>';
                },
                fillOpacity: 0.75,
                highlightOnHover: true,
                highlightFillColor: '#FC8D59',
                highlightBorderColor: 'rgba(250, 15, 160, 0.2)',
                highlightBorderWidth: 2,
                highlightFillOpacity: 0.85
            },
            arcConfig: {
              strokeColor: '#DD1C77',
              strokeWidth: 1,
              arcSharpness: 1,
              animationSpeed: 600
            }

            });

    // map.legend({
    //     legendTitle: "Implicados",
    //     defaultFillName: "No data",
    // })

    map.bubbles(

        data.bubblesdata
        //     [{
        //     name: 'Bubble 1',
        //     latitude: 1.32,
        //     longitude: -74.32,
        //     radius: 45,
        //     fillKey: 'Guerrilla'
        // }, {
        //     name: 'Bubble 2',
        //     latitude: 4.32,
        //     longitude: -74.32,
        //     radius: 25,
        //     fillKey: 'Guerrilla'
        // }, {
        //     name: 'Bubble 3',
        //     latitude: 3.32,
        //     longitude: -73.92,
        //     radius: 35,
        //     fillKey: 'bubble1'
        // }]

        , {
            borderWidth: 2,
            // borderColor: '#ff6a37',
            popupOnHover: true,
            fillOpacity: 0.5,
            highlightOnHover: true,
            highlightFillColor: '#38fc65',
            // highlightBorderColor: '#760143',
            highlightBorderWidth: 5,
            highlightFillOpacity: 0.85,
            popupTemplate: function(geo, data) {
                return "<div class='hoverinfo'>" + data.NOMBRE_MPI + "";
            }
        });



    //sample of the arc plugin

    //bubbles, custom popup on hover template

    //make responsive
    //alternatively with d3
    d3.select(window).on('resize', function() {
        map.resize();
    });

    </script>
</body>
